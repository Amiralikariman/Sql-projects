--Create table containing books I've rated on Goodreads
CREATE TABLE books_read (
    id INTEGER PRIMARY KEY,
    title TEXT,
    author TEXT,
    genre TEXT,
    year_read INTEGER,
    my_rating INTEGER,
    goodreads_rating INTEGER);
    
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Queenie", "Candice Carty-Williams", "New adult fiction", 2022, 3, 3.88);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Mrs. Palfrey at the Claremont", "Elizabeth Taylor", "Literary fiction", 2022, 4, 4);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Tales from the Cafe", "Toshikazu Kawaguchi", "Magical realism", 2022, 3, 3.99);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Woman of the Ashes", "Mia Cuoto", "Historical fiction", 2022, 2, 3.84);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("If Beale Street Could Talk", "James Baldwin", "Fiction", 2022, 4, 4.27);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Writers at Work Around the World", "The Paris Review", "Nonfiction", 2022, 4, 4.5);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Convenience Store Woman", "Sayaka Murata", "Fiction", 2022, 3, 3.72);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Things Fall Apart", "Chinua Achebe", "Historical fiction", 2022, 4, 3.71);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Before the Coffee Gets Cold", "Toshikazu Kawaguchi", "Magical realism", 2021, 4, 3.75);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("Dear America: Notes of an Undocumented Citizen", "Jose Antonio Vargas", "Nonfiction", 2021, 4.31);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("Little Weirds", "Jenny Slate", "Autobiography", 2021, 3.85);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Brave New World", "Aldous Huxley", "Dystopian Fiction", 2021, 4, 3.99);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Sincerely,", "F.S. Yousaf", "Poetry", 2021, 3, 3.86);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Handmaid's Tale", "Margaret Atwood", "Dystopian fiction", 2021, 3, 4.12);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Nickel and Dimed: On (Not) Getting by in America", "Barbara Ehrenreich", "Nonfiction", 2021, 2, 3.64);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Bell Jar", "Sylvia Plath", "Autobiographical novel", 2021, 4, 4.03);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("After the Winter", "Guadalupe Nettel", "Literary fiction", 2021, 3, 3.75);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("At Dusk", "Hwang Sok-yong", "Psychological fiction", 2021, 3, 3.69);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("A Little Life", "Hanya Yanagihara", "Fiction", 2021, 2, 4.33);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("The Glass Castle", "Jeannette Walls", "Autobiography", 2021, 4.29);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Catcher in the Rye", "J.D. Salinger", "Fiction", 2021, 4, 3.81);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Ask Again, Yes", "Mary Beath Keane", "Fiction", 2020, 4, 3.95);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Frankenstein", "Mary Shelley", "Science fiction", 2020, 4, 3.84);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Lolita", "Vladimir Nabokov", "Fiction", 2020, 3, 3.88);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Deathly Hallows", "J.K. Rowling", "Children's literature", 2020, 4, 4.62);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Gone Girl", "Gillian Flynn", "Thriller", 2020, 3, 4.11);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Sky Isn't Visible from Here", "Felicia Sullivan", "Autobiography", 2020, 2, 3.74);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Little Women", "Louisa May Alcott", "Children's literature", 2020, 4, 4.12);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Holes", "Louis Sachar", "Children's literature", 2020, 4, 3.98);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("The Case for Reparations", "Ta-Nehisi Coates", "Nonfiction", 2020, 4.64);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Half-Blood Prince", "J.K. Rowling", "Children's literature", 2020, 3, 4.57);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("After the Quake", "Haruki Murakami", "Fiction", 2020, 3, 3.78);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Flowers for Algernon", "Daniel Keyes", "Science fiction", 2020, 4, 4.17);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Who's Afraid of Virginia Woolf?", "Edward Albee", "Play", 2020, 4, 4.06);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Hunger Makes Me a Modern Girl", "Carrie Brownstein", "Autobiography", 2020, 3, 3.82);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Order of the Phoenix", "J.K. Rowling", "Children's literature", 2020, 3, 4.5);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Three Musketeers", "Alexandre Dumas", "Historical Fiction", 2020, 3, 4.08);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Writers at Work: Volume 3", "The Paris Review", "Nonfiction", 2020, 2, 4.25);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Revival", "Stephen King", "Thriller", 2020, 3, 3.79);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Goblet of Fire", "J.K. Rowling", "Children's literature", 2020, 3, 4.57);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Skipping Christmas", "John Grisham", "Humor", 2019, 3, 3.52);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Little House", "Virginia Lee Burton", "Children's literature", 2019, 3, 4.28);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Prisoner of Azkaban", "J.K. Rowling", "Children's literature", 2019, 4, 4.58);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Talking as Fast as I Can: From Gilmore Girls to Gilmore Girls", "Lauren Graham", "Autobiography", 2019, 3, 3.95);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potter and the Chamber of Secrets", "J.K. Rowling", "Children's literature", 2019, 3, 4.43);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Metamorphosis", "Franz Kafka", "Fantasy Fiction", 2019, 3, 3.84);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Harry Potters and the Sorcerer's Stone", "J.K. Rowling", "Children's literature", 2019, 4, 4.48);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Naturally Tan", "Tan France", "Autobiography", 2019, 4, 3.81);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Time Machine", "H.G. Wells", "Science fiction", 2019, 3, 3.9);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("My Vanishing African Dreams", "Susan Hall", "Autobiography", 2019, 4.4);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("As Good As True", "Cheryl Reid", "Historical fiction", 2019, 2, 3.75);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("A Farewell to Arms", "Ernest Hemingway", "Fiction", 2019, 3, 3.81);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("The Enneagram Made Easy: Discover the 9 Types of People", "Renee Baron", "Nonfiction", 2019, 3.84);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Fahrenheit 451", "Ray Bradbury", "Science fiction", 2019, 3, 3.98);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("And Then There Were None", "Agatha Christie", "Mystery", 2019, 4, 4.27);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("And the Mountains Echoed", "Khaled Hosseini", "Historical fiction", 2019, 4, 4.06);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("One More Thing: Stories and Other Stories", "B.J. Novak", "Fiction", 2019, 2, 3.67);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Adventures of Huckleberry Finn", "Mark Twain", "Fiction", 2019, 3, 3.82);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("On Writing: A Memoir of the Craft", "Stephen King", "Nonfiction", 2019, 4, 4.33);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("I'm Not Here to Give a Speech", "Gabriel Garcia Marquez", "Biography", 2019, 3, 3.98);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("1984", "George Orwell", "Dystopian fiction", 2019, 4, 4.19);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Educated", "Tara Westover", "Autobiography", 2019, 4, 4.47);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Chronicle of a Death Foretold", "Gabriel Garcia Marquez", "Fiction", 2019, 4, 3.97);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Wild Robot", "Peter Brown", "Children's literatuer", 2019, 4, 4.04);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Through the Looking-Glass and What Alice Found There", "Lewis Carroll", "Children's literature", 2019, 3, 4.04);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Beekeeper's Apprentice", "Laurie R. King", "Mystery", 2019, 2, 4.05);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Bossypants", "Tina Fey", "Autobiography", 2019, 3, 3.95);
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("The Essential Enneagram", "David N. Daniels", "Nonfiction", 2019, 3.68);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("State of Fear", "Michael Crichton", "Thriller", 2019, 3, 3.7);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("A Thousand Splendid Suns", "Khaled Hoseini", "Fiction", 2019, 4, 4.4);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Lord of the Flies", "William Golding", "Fiction", 2019, 3, 3.69);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Heidi", "Johanna Spyri", "Children's literature", 2019, 4, 4.01);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Call of the Wild", "Jack London", "Adventure fiction", 2019, 3, 3.89);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Zahir", "Paulo Coelho", "Psychological fiction", 2019, 1, 3.58);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Help", "Kathryn Sockett", "Historical fiction", 2019, 3, 4.46);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Quiet: The Power of Introverts in a World That Can't Stop Talking", "Susan Cain", "Nonfiction", 2019, 4, 4.07);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Tulip Fever", "Deborah Moggach", "Historical fiction", 2019, 3, 3.52);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Bon Voyage Mr. President and Other Stories", "Gabriel Garcia Marquez", "Fiction", 2019, 3, 3.63);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("To Have and Have Not", "Ernest Hemingway", "Fiction", 2019, 3, 3.54);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Prey", "Michael Crichton", "Science fiction", 2019, 2, 3.77);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Hiroshima", "John Hersey", "Nonfiction", 2019, 4, 4);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Goldfinch", "Donna Tartt", "Literary fiction", 2019, 3, 3.93);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Till We Have Faces", "C.S. Lewis", "Fantasy fiction", 2019, 4, 4.16);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Actor's Life: A Survival Guide", "Jenna Fischer", "Nonfiction", 2019, 3, 4.15);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("News of a Kidnapping", "Gabriel Garcia Marquez", "Nonfiction", 2019, 3, 3.87);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Writers at Work: Volume 6", "The Paris Review", "Nonfiction", 2018, 4, 4.25);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Tender Is the Night", "F. Scott Fitzgerald", "Fiction", 2018, 2, 3.8);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("My Antonia", "Willa Cather", "Historical fiction", 2018, 4, 3.81);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Of Norwegian Ways", "Bent Vanberg", "Nonfiction", 2018, 2, 3.28);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Modern Romance", "Aziz Ansari", "Nonfiction", 2018, 4, 3.81);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Writers at Work: Volume 8", "The Paris Review", "Nonfiction", 2018, 4, 4.14);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Ender's Game", "Orson Scott Card", "Science fiction", 2018, 4, 4.3);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Zahir", "Paulo Coelho", "Psychological fiction", 2019, 1, 3.58);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Yes Please", "Amy Poehler", "Autobiography", 2018, 4, 3.84);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Is Everyone Hanging Out Without Me?", "Mindy Kaling", "Autobiography", 2018, 4, 3.86);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Nice Girls Don't Get the Corner Office", "Lois P. Frankel", "Nonfiction", 2018, 3, 3.69);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Beast Within", "Serena Valentino", "Fiction", 2018, 1, 3.77);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Things They Carried", "Tim O'Brien", "Historical fiction", 2018, 3, 4.13);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Boy's Life", "Robert McCammon", "Mystery", 2018, 5, 4.37);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Girl on the Train", "Paula Hawkins", "Thriller", 2018, 3, 3.95);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Kite Runner", "Khaled Hosseini", "Historical fiction", 2018, 4, 4.32);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("To Kill a Mockingbird", "Harper Lee", "Fiction", 2018, 4, 4.27);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Mockingjay", "Suzanne Collins", "Young adult fiction", 2018, 3, 4.06);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Ultimate Law Firm Associate's Marketing Checklist", "Ross Fishman", "Nonfiction", 2018, 3, 4);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Catching Fire", "Suzanne Collins", "Young adult fiction", 2018, 4, 4.3);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Hunger Games", "Suzanne Collins", "Young adult fiction", 2018, 4, 4.32);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Horizon", "Scott Westerfeld", "Adventure fiction", 2018, 3, 3.76);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Bassoon King", "Rainn Wilson", "Autobiography", 2018, 4, 3.72);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Anne of Green Gables", "L.M. Montgomery", "Children's literature", 2018, 4, 4.28);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Why Not Me?", "Mindy Kaling", "Autobiograhpy", 2018, 3, 3.9);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("One Hundred Years of Solitude", "Gabriel Garcia Marquez", "Magical realism", 2017, 5, 4.1);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Sea Wolf", "Jack London", "Adventure fiction", 2017, 4, 4.04);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("The Ruins of Us", "Keija Parssinen", "Literary fiction", 2017, 3, 3.64);
INSERT INTO books_read (title, author, genre, year_read, my_rating, goodreads_rating) VALUES ("Flight Behavior", "Barbara Kingsolver", "Literary fiction", 2017, 2, 3.79);

--Display all books I've rated through Goodreads from highest to lowest rating
SELECT title, author, my_rating, goodreads_rating 
    FROM books_read 
    ORDER BY my_rating DESC;

--Display which authors I've read more than once, sorted from most to least works read
SELECT author, COUNT(*) AS total_by_author 
    FROM books_read 
    GROUP BY author
    HAVING total_by_author > 1
    ORDER BY total_by_author DESC;
    
--Which books did I rate higher than the Goodreads average rating?
SELECT title, author, my_rating, goodreads_rating
    FROM books_read
    WHERE my_rating > goodreads_rating
    ORDER BY my_rating DESC;
    
--Which books did I rate lower than the Goodreads average rating?
SELECT title, author, goodreads_rating, my_rating
    FROM books_read
    WHERE my_rating < goodreads_rating
    ORDER BY goodreads_rating DESC;

--Update table with a new rating for Lolita
SELECT id, title, my_rating FROM books_read WHERE title = "Lolita";

UPDATE books_read SET my_rating = 4 WHERE id = 24;

SELECT id, title, my_rating FROM books_read WHERE id = 24;

--Update table with a new book read
INSERT INTO books_read (title, author, genre, year_read, goodreads_rating) VALUES ("Verge", "Lidia Yuknavitch", "Literary fiction", 2022, 3.67);

SELECT id, title, author, goodreads_rating FROM books_read WHERE title = "Verge";

--Practice deleting data from the table
SELECT id, title, author FROM books_read WHERE id > 100;

DELETE FROM books_read WHERE id = 115;

SELECT id, title, author FROM books_read WHERE id > 100;

--Display table data sorted by genre
SELECT genre, COUNT(*) as by_genre FROM books_read
    GROUP BY genre
    ORDER BY by_genre DESC;
    
--Update table with corrected typos and title case vs. sentence case
SELECT id, title, genre FROM books_read WHERE genre = "Children's literatuer";

UPDATE books_read SET genre = "Children's literature" WHERE id = 64;

SELECT id, title, genre FROM books_read WHERE id = 64;

SELECT id, title, genre FROM books_read WHERE genre = "Historical Fiction";

UPDATE books_read SET genre = "Historical fiction" WHERE id = 37;

SELECT id, title, genre FROM books_read WHERE id = 37;

SELECT id, title, genre FROM books_read WHERE genre = "Fantasy Fiction";

UPDATE books_read SET genre = "Fantasy fiction" WHERE id = 46;

SELECT id, title, genre FROM books_read WHERE id = 46;

UPDATE books_read SET genre = "Psychological fiction" WHERE id = 1;

SELECT id, title, genre FROM books_read WHERE id = 1;

--Display table data sorted by genre with updates
SELECT genre, COUNT(*) as by_genre FROM books_read
    GROUP BY genre
    ORDER BY by_genre DESC;
    
--What is my average rating for each genre?
SELECT genre, AVG(my_rating) as average_rating, COUNT(*) as by_genre FROM books_read
    GROUP BY genre
    ORDER BY average_rating DESC;
    
--Create table containing Booker Prize winners published after 2016
CREATE TABLE booker_prize_winners (
    id INTEGER PRIMARY KEY,
    title TEXT,
    author TEXT,
    year_won INTEGER,
    genre TEXT,
    goodreads_rating INTEGER);
    
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Promise", "Damon Galgut", 2021, "Literary fiction", 3.98);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Shuggie Bain", "Douglas Stuart", 2020, "Literary fiction", 4.33);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Testaments", "Margaret Atwood", 2019, "Dystopian fiction", 4.20);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Girl, Woman, Other", "Bernadine Evaristo", 2019, "Literary fiction", 4.34);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Milkman", "Anna Burns", 2018, "Psychological fiction", 3.54);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Lincoln in the Bardo", "George Saunders", 2017, "Historical fiction", 3.75);

--What is the average difference between my ratings and Goodreads' average ratings for each genre read?
SELECT genre, ROUND(goodreads_rating - my_rating, 2) AS rating_difference FROM books_read
    GROUP BY genre
    ORDER BY rating_difference DESC;

--Update Booker Prize table with books published between 2000 and 2016
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Sellout", "Paul Beatty", 2016, "Literary fiction", 3.75);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("A Brief History of Seven Killings", "Marlon James", 2015, "Historical fiction", 3.89);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Narrow Road to the Deep North", "Richard Flanagan", 2014, "Historical fiction", 4.02);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Luminaries", "Eleanor Catton", 2013, "Historical fiction", 3.73);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Bring Up the Bodies", "Hilary Mantel", 2012, "Historical fiction", 4.25);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Sense of an Ending", "Julian Barnes", 2011, "Psycholigcal fiction", 3.73);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Elected Member", "Bernice Rubens", 2010, "Literary fiction", 3.65);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Finkler Question", "Howard Jacobson", 2010, "Fiction", 2.8);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Wolf Hall", "Hilary Mantel", 2009, "Historical fiction", 3.89);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The White Tiger", "Aravind Adiga", 2008, "Mystery", 3.76);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Gathering", "Anne Enright", 2007, "Literary fiction", 3.1);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Inheritance of Loss", "Kiran Desai", 2006, "Psychological fiction", 3.44);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Sea", "John Banville", 2005, "Psychological fiction", 3.53);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Line of Beauty", "Alan Hollinghurst", 2004, "Historical fiction", 3.73);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Vernon God Little", "DBC Pierre", 2003, "Fiction", 3.59);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("Life of Pi", "Yann Martel", 2002, "Adventure fiction", 3.93);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("True History of the Kelly Gang", "Peter Carey", 2001, "Historical fiction", 3.83);
INSERT INTO booker_prize_winners (title, author, year_won, genre, goodreads_rating) VALUES ("The Blind Assassin", "Margaret Atwood", 2000, "Psychological fiction", 3.96);

--Create table predicting my ratings per genre based on the difference between my ratings and Goodreads' average ratings
CREATE TABLE predicting_ratings (
    id  INTEGER PRIMARY KEY,
    genre TEXT,
    average_rating_difference INTEGER);

SELECT genre, ROUND(my_rating - goodreads_rating, 2) AS average_rating_difference FROM books_read
    GROUP BY genre
    ORDER BY average_rating_difference DESC;
    
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Magical realism", 0.9);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Mystery", 0.63);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Autobiography", 0.28);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Autobiographical novel", -0.03);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Adventure fiction", -0.04);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Play", -0.06);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Fantasy fiction", -0.16);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Dystopian fiction", -0.19);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Fiction", -0.27);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Children's literature", -0.28);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Science fiction", -0.3);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Historical fiction", -0.32);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Young adult fiction", -0.32);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Humor", -0.52);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Poetry", -0.86);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Autobiography", -0.9);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Thriller", -0.95);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Biography", -0.98);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Nonfiction", -1);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Literary fiction", -1.79);
INSERT INTO predicting_ratings (genre, average_rating_difference) VALUES ("Psychological fiction", -2.58);

--Based on predicting_ratings data, what is my predicted rating for Booker Prize winners published after 1999?
SELECT booker_prize_winners.title, booker_prize_winners.author, booker_prize_winners.genre, ROUND(booker_prize_winners.goodreads_rating + predicting_ratings.average_rating_difference,2) AS amys_predicted_rating FROM booker_prize_winners
    JOIN predicting_ratings
    ON booker_prize_winners.genre = predicting_ratings.genre
    ORDER BY amys_predicted_rating DESC;
